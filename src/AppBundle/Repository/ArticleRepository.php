<?php

namespace AppBundle\Repository;

use Doctrine\ORM\EntityRepository;

/**
 * ArticleRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class ArticleRepository extends EntityRepository
{
    public function getDTO($id)
    {
        $qb = $this->createQueryBuilder('a')
        ->join('a.type','t')
        ->join('a.subType','s')
        ->select('a.title')
        ->addSelect('t.id')
        ->addSelect('s.id')
        ->addSelect('a.abstract')
        ->addSelect('IF(a.maxBeginDate IS NULL,true,false) AS isBeginDateApprox')
        ->addSelect('a.minBeginDate')
        ->addSelect('a.maxBeginDate')
        ->addSelect('IF(a.minEndDate IS NULL,true,false) AS isEndDateApprox')
        ->addSelect('a.minEndDate')
        ->addSelect('a.maxEndDate')
        ->where('a.id = :id')
        ->setParameter('id', $id);
        
        return $qb->getQuery()->getArrayResult();
    }
}
